<!DOCTYPE html>
<html lang="">

<head>
    <meta charset="UTF-8">
    <meta name="theme-color" content="#990000">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>PacketHuffer</title>
    <meta name="Author" content="" />

    <script src="bower_components/webcomponentsjs/webcomponents.js"></script>
    <link rel="import" href="bower_components/polymer/polymer.html">
    <link rel="import" href="bower_components/font-roboto/roboto.html">
    <link rel="import" href="bower_components/paper-button/paper-button.html">
    <link rel="import" href="bower_components/core-ajax/core-ajax.html">
    <link rel="import" href="bower_components/paper-spinner/paper-spinner.html">
    <link rel="import" href="bower_components/core-list/core-list.html">
    <link rel="import" href="bower_components/paper-input/paper-input-decorator.html">
    <link rel="import" href="bower_components/paper-tabs/paper-tabs.html">
    <link rel="import" href="bower_components/paper-tabs/paper-tab.html">
    <link rel="import" href="bower_components/core-pages/core-pages.html">

    <style>
        html,
        body {
            font-family: 'RobotoDraft', sans-serif;
            -webkit-tap-highlight-color: transparent;
            height: 100%;
            width: 100%;
            padding: 0;
            margin: 0;
        }
    </style>
</head>

<body>

    <polymer-element name="packet-huffer">
        <template>
            <style>
                .wrapper {
                    //padding: 20px;
                }
                
                core-list {
                    height: 30vh;
                }
                
                .row {
                    padding: 20px;
                    border-bottom: 1px solid #ccc;
                    cursor: pointer;
                }
                
                .selection-display {
                    background: lightgray;
                }
                
                .selected {
                    background: silver;
                }
                
                
                .table-heading {
                    font-weight: bold;
                }
                
                paper-tabs paper-tab::shadow #ink {
                    color: #407bff;
                }
                
                paper-tabs::shadow #selectionBar {
                    background-color: #407bff;
                }
                
                .section {
                    padding: 30px;
                }
                .data-heading {
                    color: #666;
                    font-weight: bold;
                }
                .data-item {
                    padding-left: 40px;
                }
                .data {
                    margin-top: 20px;
                    margin-bottom: 20px;
                    background: rgba(0,0,0,0.1);
                    padding: 10px;
                    border-radius: 3px;
                }
                .data-segment {
                    margin-bottom: 10px;
                }
            </style>

            <div class="wrapper">

                <paper-tabs selected="{{selected}}">
                    <paper-tab>Capture Packets</paper-tab>
                    <paper-tab>Throughput</paper-tab>
                </paper-tabs>

                <div horizontal layout center class="wrapper-top">


                    <core-pages selected="{{selected}}" flex>
                        <div class="section">
                            <div layout horizontal flex>
                                <div>
                                    <paper-button on-tap="{{startPH}}">Start</paper-button>
                                </div>
                                <div>
                                    <paper-button on-tap="{{stopPH}}">Stop</paper-button>
                                </div>
                                <div>
                                    <paper-spinner active="{{loading}}"></paper-spinner>
                                </div>
                                <div flex></div>
                                <div>
                                    <paper-input-decorator label="Filter:" floatingLabel>
                                        <input is="core-input">
                                    </paper-input-decorator>
                                </div>
                            </div>
                            <div>
                                <div class="row table-heading" flex horizontal layout>
                                    <div flex>#</div>
                                    <div flex>Source</div>
                                    <div flex>Destination</div>
                                    <div flex>Total Size of Data </div>
                                    <div flex>Time-to-Live</div>

                                    <div flex>Protocol </div>

                                </div>
                                <core-list id="list" data="{{response3}}" height="80" flex selectionEnabled="true" selection="{{selection}}">
                                    <template>
                                        <div class="row  {{ {selected: selected} | tokenList }}" horizontal layout>
                                            <div flex> {{model.packetNumber}} </div>
                                            <div flex> {{model.sourceAddress}} </div>
                                            <div flex> {{model.destinationAddress}} </div>
                                            <div flex> {{model.totalLength}} </div>
                                            <div flex> {{model.TTL}} </div>
                                            <div flex> {{model.protocol}} </div>

                                        </div>
                                    </template>
                                </core-list>

                                <div class="data" hidden?="{{!selection}}">
                                    <div class="data-segment">
                                        <div class="data-heading">Source Port</div>
                                        <div class="data-item"></div>
                                    </div>
                                    <div class="data-segment">
                                        <div class="data-heading">Destination Port</div>
                                        <div class="data-item"></div>
                                    </div>
                                    <div class="data-segment">
                                        <div class="data-heading">Sequence No</div>
                                        <div class="data-item"></div>
                                    </div>
                                    <div class="data-segment">
                                        <div class="data-heading">Acknowledge No</div>
                                        <div class="data-item"></div>
                                    </div>
                                    <div class="data-segment">
                                        <div class="data-heading">Window Size</div>
                                        <div class="data-item"></div>
                                    </div>
                                    <div class="data-segment">
                                        <div class="data-heading">MAC Address</div>
                                        <div class="data-item"></div>
                                    </div>
                                    <div class="data-segment">
                                        <div class="data-heading">Data</div>
                                        <div class="data-item">{{selectedItem.data}}</div>
                                    </div>

                                    
                                    
                                    
                                    
                                    
                                    
                                </div>

                            </div>

                        </div>
                        <div>Page 2</div>
                    </core-pages>

                </div>




            </div>



            <core-ajax loading="{{loading}}" progress={{progress}} id="startPH" auto="false" method="GET" contentType="application/json" url="cgi-bin/app.py" response="{{response}}" on-core-response="{{infoloaded}}" handleAs="json">
            </core-ajax>

            <core-ajax loading="{{loading2}}" id="controller" auto="false" method="GET" contentType="application/json" url="cgi-bin/controller.py?status={{status}}" response="{{response2}}" handleAs="json">
            </core-ajax>

            <core-ajax loading="{{loading3}}" id="data" auto method="GET" contentType="application/json" url="log.json" response="{{response3}}" handleAs="json">
            </core-ajax>
        </template>


        <script>
            Polymer({
                created: function () {
                    this.selected = 0;
                },
                ready: function () {
                    this.status = "start";
                    this.$.controller.go();
                    this.count = 0;
                },
                startPH: function () {
                    this.status = "start";
                    this.$.controller.go();
                    this.$.startPH.go();
                    //this.updateData();
                },
                updateData: function () {
                    this.$.data.go();
                    location.reload();
                },
                stopPH: function () {
                    this.status = "stop";
                    //this.$.startPH.abort();
                    this.$.controller.go();
                    this.updateData();
                },
                loadingChanged: function () {
                    //this.updateData();  
                },
                selectionChanged: function () {
                    this.selectedItem = this.$.list.selection;
                }
            });
        </script>

    </polymer-element>

    <packet-huffer></packet-huffer>

</body>

</html>